<?xml version="1.0" encoding="UTF-8" ?>
<ruleset
  name="KIA Full Scan Rules"
  xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd"
>

    <description>
        These are the all set of rules to trigger scan manually in Salesforce
        We can edit this list and add future rules to make validation more strict
    </description>

    <!-- Apex Rules -->

    <rule
    ref="category/apex/performance.xml/OperationWithLimitsInLoop"
    message="De NOT define DML in a loopset"
  >
        <priority>1</priority>
    </rule>

    <rule
    ref="category/apex/bestpractices.xml/ApexUnitTestClassShouldHaveAsserts"
  >
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/AvoidDirectAccessTriggerMap">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/AvoidHardcodingId">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/InaccessibleAuraEnabledGetter">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/TestMethodsMustBeInTestClasses">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexSOQLInjection">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexXSSFromURLParam">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexBadCrypto">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexDangerousMethods">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/ApexCSRF">
        <priority>2</priority>
    </rule>

    <rule
    ref="category/apex/errorprone.xml/EmptyCatchBlock"
    message="Empty Catch Block finds instances where an exception is caught, but nothing is done. In most circumstances, this swallows an exception which should either be acted on or reported. Atleast catch the error and log it into error logging"
  >
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyIfStmt">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyWhileStmt">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyStatementBlock">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/OverrideBothEqualsAndHashcode">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexSharingViolations">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexInsecureEndpoint">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexCRUDViolation">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/AvoidLogicInTrigger">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/ClassNamingConventions">
        <priority>3</priority>
        <properties>
            <property name="testClassPattern" value="[A-Z][a-zA-Z0-9_]*" />
            <property name="abstractClassPattern" value="[A-Z][a-zA-Z0-9_]*" />
            <property name="classPattern" value="[A-Z][a-zA-Z0-9_]*" />
            <property name="interfacePattern" value="[A-Z][a-zA-Z0-9_]*" />
            <property name="enumPattern" value="[A-Z][a-zA-Z0-9_]*" />
        </properties>
    </rule>

    <rule ref="category/apex/codestyle.xml/FieldDeclarationsShouldBeAtStart">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/MethodNamingConventions">
        <priority>3</priority>
        <properties>
            <property name="testPattern" value="[a-z][a-zA-Z0-9]*" />
            <property name="staticPattern" value="[a-z][a-zA-Z0-9]*" />
            <property name="instancePattern" value="[a-z][a-zA-Z0-9]*" />
        </properties>
    </rule>

    <rule ref="category/apex/codestyle.xml/PropertyNamingConventions">
        <priority>3</priority>
        <properties>
            <property name="staticPattern" value="[a-z][a-zA-Z0-9]*" />
            <property name="instancePattern" value="[a-z][a-zA-Z0-9]*" />
        </properties>
    </rule>

    <rule ref="category/apex/codestyle.xml/IfStmtsMustUseBraces">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/WhileLoopsMustUseBraces">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/IfElseStmtsMustUseBraces">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/ForLoopsMustUseBraces">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/OneDeclarationPerLine">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/design.xml/ExcessiveClassLength">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/design.xml/ExcessiveParameterList">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/design.xml/AvoidDeeplyNestedIfStmts">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/design.xml/CyclomaticComplexity">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/AvoidNonExistentAnnotations">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/MethodWithSameNameAsEnclosingClass">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyTryOrFinallyBlock">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexXSSFromEscapeFalse">
        <priority>3</priority>
    </rule>

    <rule ref="category/apex/design.xml/CognitiveComplexity">
        <priority>4</priority>
    </rule>

    <rule
    ref="category/apex/bestpractices.xml/ApexAssertionsShouldIncludeMessage"
  >
        <priority>5</priority>
    </rule>

    <rule
    ref="category/apex/bestpractices.xml/ApexUnitTestMethodShouldHaveIsTestAnnotation"
  >
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/AvoidGlobalModifier">
        <priority>5</priority>
    </rule>

    <rule
    ref="category/apex/bestpractices.xml/ApexUnitTestShouldNotUseSeeAllDataTrue"
  >
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/UnusedLocalVariable">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/DebugsShouldUseLoggingLevel">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/FieldNamingConventions">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/FormalParameterNamingConventions">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/LocalVariableNamingConventions">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/design.xml/ExcessivePublicCount">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/design.xml/NcssConstructorCount">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/design.xml/NcssMethodCount">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/design.xml/NcssTypeCount">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/design.xml/TooManyFields">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/documentation.xml/ApexDoc">
        <priority>5</priority>
    </rule>

    <rule ref="category/apex/performance.xml/AvoidDebugStatements">
        <priority>5</priority>
    </rule>

    <!-- XML Metadata Rules -->

    <rule
    ref="scripts/pmd/category/xml/xml_custom_rules.xml/UnrestrictedPasswordPolicy"
  >
        <priority>2</priority>
    </rule>

    <rule
    ref="scripts/pmd/category/xml/xml_custom_rules.xml/TooShortPasswordPolicy"
  >
        <priority>2</priority>
    </rule>

    <rule
    ref="scripts/pmd/category/xml/xml_custom_rules.xml/PasswordsNeverExpire"
  >
        <priority>2</priority>
    </rule>

    <rule
    ref="scripts/pmd/category/apex/apex_custom_rules.xml/CatchCreateExceptionLog"
  >
        <priority>2</priority>
    </rule> 
</ruleset>
